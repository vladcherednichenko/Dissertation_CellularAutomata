!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.VoxParser={})}(this,function(n){"use strict";var t=["diffuse","metal","glass","emissive"],e={PACK:function(n){return{numModels:n.nextInt()}},SIZE:function(n){return n.nextPattern(["x","y","z"],4)},XYZI:function(n){for(var t=n.nextInt(),e=[],r=0;r<t;r++)e.push(n.nextPattern(["x","y","z","i"],1));return{numVoxels:t,voxels:e}},RGBA:function(n){for(var t=[],e=0;e<256;e++)t.push(n.nextPattern(["r","g","b","a"],1));return{palette:t}},MATT:function(n){var e=n.nextInt(),r=n.nextInt(),i=n.nextFloat(),o=n.nextInt(),u=[(1&o)>0&&"plastic",(2&o)>0&&"roughness",(4&o)>0&&"specular",(8&o)>0&&"ior",(16&o)>0&&"attenuation",(32&o)>0&&"power",(64&o)>0&&"glow",(128&o)>0&&"isTotalPower"].filter(Boolean).map(function(t){return{property:t,value:"isTotalPower"!==t?n.nextFloat():null}});return{id:e,materialType:t[r],materialWeight:i,properties:u}}},r=function(n){var t=new DataView(n),e=0;return{hasNext:function(){return e<t.byteLength},nextString:function(){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(t.getUint8(e,!0)),e+=1;return n},nextInt:function(){var n=t.getUint32(e,!0);return e+=4,n},nextFloat:function(){var n=t.getFloat32(e,!0);return e+=4,n},nextPattern:function(n,r){return n.reduce(function(n,i){return n[i]=t["getUint"+8*r](e,!0),e+=r,n},{})}}},i=function(n){return{id:n.nextString(),version:n.nextInt()}},o=function(n){return{id:n.nextString(),numContent:n.nextInt(),numChildren:n.nextInt()}},u=function(n){var t=o(n),r=e[t.id];if("function"==typeof r)return Object.assign(t,{content:r(n)});throw new Error("Unrecognized chunk id: '"+t.id+"'")},a=function(n){for(var t=[];n.hasNext();){var e=u(n);t.push(e)}return t};n.parse=function(n){var t=r(n),e=i(t);if("VOX "!==e.id)throw new Error("Expected file id 'VOX ', found: '"+e.id+"'");var u=o(t);if("MAIN"!==u.id)throw new Error("Expected 'MAIN' chunk, found: '"+u.id+"'");return{id:e.id,version:e.version,body:Object.assign(u,{children:a(t)})}},Object.defineProperty(n,"__esModule",{value:!0})});
